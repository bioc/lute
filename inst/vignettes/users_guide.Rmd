---
title: "The lute user's guide"
author: "Sean Maden"
date: "2022-12-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# The `lute` package

This package was written to aid ongoing development and testing of deconvolution
functions, with main focus on applications for transcriptomics datasets. Inside, 
you will find resources in the form of functions, vignettes, and datasets that you 
can use to learn about deconvolution methods and study the behavior of deconvolution under certain key settings. We also encourage cross-domain exploration of different approaches to deconvolution, in the hopes this will accelerate research progress 
and lead to new breakthoughs in the discipline. Whether you are new to the subject 
or just refreshing your deconvolution knowledge, we hope you find `lute` a handy resource for your research. Community feedback, bug reports, and suggested updates 
are encouraged on our [GitHub page.]()

# Deconvolution basics

To perform deconvolution, we need to consider the following terms:

* $p$ : Vector of true type proportions. These correspond to the columns in $Z$, 
and the ordering of types should be the same in each.
* $Z$ : The reference/signature matrix consisting of types (columns) and markers (rows)
and the signal amounts (e.g. expression logcounts, etc.). The columns correspond to
values in $p$, and the rows correspond to rows in $Y$.
* $Y$ : The convoluted signal matrix for which we wish to generate deconvolution 
predictions by type. The rows in $Y$ correspond to the rows in $Z$, and the columns
correspond to samples (e.g. bulk tissue samples, etc.).

The essence of deconvolution is to predict or solve for $p$, given $Y$ and $Z$.
In other words, we take $p$ as follows:

$$p \leftarrow [Y, Z]$$

Typically, we attempt (1) with the assumption that the following holds, where 
each term is typically expressed as a matrix:

$$Y = Z * p$$

As discussed below, the details of how each term is prepared or derived is vital
for understanding and optimizing deconvolution methods. In your research you may 
find alternate names and symbols used to refer to $p$, $Y$, and $Z$, but in most 
cases the essential formula remains unchanged.

## Strict deconvolution versus deconvolution preparation

To aid an understanding of how a deconvolution method works, it is important to
have clear terminology. Throughout `lute` documentation, we refer to ``strict deconvolution.'' By this, we mean any method for calculating $p$ given some $Y$ 
and $Z$. Some examples include Non-negative Least Squares (NNLS) and Ordinary 
Least Squares (OLS), and ridge regression.

By contrast to strict deconvolution, deconvolution preparation can be any step 
conducted prior to strict deconvolution, and in particular steps to prepare $Y$ 
and $Z$, such as to mitigate cross-assay biases, reduce marker dimensions, weight markers according to relative importance, remove confounding variation, and more.

